
# Сборка проекта через Maven
#здесь мы берем образ стандартного мейввен докера для сборки жава проекта
FROM maven:3.9.4-eclipse-temurin-21 AS build
#рабочая директория внутри контейнера
WORKDIR /app
#копирование все в эту директорию
COPY . .
#здесь запускается инструмент мейвен он чистит кэш и пропускает тесты чтобы сформировать таргет
RUN mvn clean package -DskipTests

# Запуск приложения на OpenJDK 21 JRE slim-версии (меньше размер) образ из докерхаба
FROM openjdk:21-jdk
WORKDIR /app
#здесь мы из мейвен билда берем жар файл он нужен для упоковки как раз ресурсы классы конфиги тд
COPY --from=build /app/target/*.jar app.jar
#правый порт который нужно менять в ап пропертис
EXPOSE 8080
#входная точка при запуске контейнера то есть он говорит запусти нам жар файл
ENTRYPOINT ["java", "-jar", "app.jar"]
